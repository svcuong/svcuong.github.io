<!DOCTYPE html><html lang="vi-en" >

<head>

  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="generator" content="Source Themes Academic 4.8.0">

  

  
  

  
  
  
  
  
    
    
    
  
  

  <meta name="author" content="Cuong Sai">

  
  
  
    
  
  <meta name="description" content="Xác định và loại bỏ ouliers trong dữ liệu là một bước vô cùng quan trọng giúp tăng cao độ chính xác cho các mô hình dự đoán">

  
  <link rel="alternate" hreflang="vi-en" href="/blog/remove-outliers/">

  


  
  
  
  <meta name="theme-color" content="#06805E">
  

  
  
  
  <script src="/js/mathjax-config.js"></script>
  

  
  
  
  
    
    
      <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/academicons/1.8.6/css/academicons.min.css" integrity="sha256-uFVgMKfistnJAfoCUQigIl+JfUaP47GrRKjf6CTPVmw=" crossorigin="anonymous">
    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.14.0/css/all.min.css" integrity="sha256-FMvZuGapsJLjouA6k7Eo2lusoAX9i0ShlWFG6qt7SLc=" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.5.7/jquery.fancybox.min.css" integrity="sha256-Vzbj7sDDS/woiFS3uNKo8eIuni59rjyNGtXfstRzStA=" crossorigin="anonymous">

    
    
    
      
    
    
      
      
        
          <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.1.2/styles/github.min.css" crossorigin="anonymous" title="hl-light">
          <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.1.2/styles/dracula.min.css" crossorigin="anonymous" title="hl-dark" disabled>
        
      
    

    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.5.1/leaflet.css" integrity="sha256-SHMGCYmST46SoyGgo4YR/9AlK1vf3ff84Aq9yK4hdqM=" crossorigin="anonymous">
    

    

    
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
        <script src="https://cdnjs.cloudflare.com/ajax/libs/lazysizes/5.1.2/lazysizes.min.js" integrity="sha256-Md1qLToewPeKjfAHU1zyPwOutccPAm5tahnaw7Osw0A=" crossorigin="anonymous" async></script>
      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
        <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js" integrity="" crossorigin="anonymous" async></script>
      
    
      

      
      

      
    

  

  
  
  
    
      
      
      <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Montserrat:400,700%7CRoboto:400,400italic,700%7CRoboto+Mono&display=swap">
    
  

  
  
  
  
  <link rel="stylesheet" href="/css/academic.css">

  





<script async src="https://www.googletagmanager.com/gtag/js?id=UA-128408660-5"></script>
<script>
  window.dataLayer = window.dataLayer || [];

  function gtag() {
      dataLayer.push(arguments);
  }

  function trackOutboundLink(url, target) {
    gtag('event', 'click', {
         'event_category': 'outbound',
         'event_label': url,
         'transport_type': 'beacon',
         'event_callback': function () {
           if (target !== '_blank') {
             document.location = url;
           }
         }
    });
    console.debug("Outbound link clicked: " + url);
  }

  function onClickCallback(event) {
    if ((event.target.tagName !== 'A') || (event.target.host === window.location.host)) {
      return;
    }
    trackOutboundLink(event.target, event.target.getAttribute('target'));  
  }

  gtag('js', new Date());
  gtag('config', 'UA-128408660-5', {});

  
  document.addEventListener('click', onClickCallback, false);
</script>


  


  
  

  

  <link rel="manifest" href="/index.webmanifest">
  <link rel="icon" type="image/png" href="/images/icon_hu47efca792e1e7000f9078d7b8f1dac48_31011_32x32_fill_lanczos_center_2.PNG">
  <link rel="apple-touch-icon" type="image/png" href="/images/icon_hu47efca792e1e7000f9078d7b8f1dac48_31011_192x192_fill_lanczos_center_2.PNG">

  <link rel="canonical" href="/blog/remove-outliers/">

  
  
  
  
  
  
  
    
    
  
  
  <meta property="twitter:card" content="summary">
  
  <meta property="og:site_name" content="CUONG SAI">
  <meta property="og:url" content="/blog/remove-outliers/">
  <meta property="og:title" content="Sử dụng thống kê để xác định và loại bỏ dữ liệu ngoại lai cho machine learning trong R và Python | CUONG SAI">
  <meta property="og:description" content="Xác định và loại bỏ ouliers trong dữ liệu là một bước vô cùng quan trọng giúp tăng cao độ chính xác cho các mô hình dự đoán"><meta property="og:image" content="/images/icon_hu47efca792e1e7000f9078d7b8f1dac48_31011_512x512_fill_lanczos_center_2.PNG">
  <meta property="twitter:image" content="/images/icon_hu47efca792e1e7000f9078d7b8f1dac48_31011_512x512_fill_lanczos_center_2.PNG"><meta property="og:locale" content="vi-en">
  
    
      <meta property="article:published_time" content="2020-08-20T00:00:00&#43;00:00">
    
    <meta property="article:modified_time" content="2020-08-20T15:43:27&#43;04:00">
  

  


    






  




<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "/blog/remove-outliers/"
  },
  "headline": "Sử dụng thống kê để xác định và loại bỏ dữ liệu ngoại lai cho machine learning trong R và Python",
  
  "datePublished": "2020-08-20T00:00:00Z",
  "dateModified": "2020-08-20T15:43:27+04:00",
  
  "author": {
    "@type": "Person",
    "name": "Cuong Sai"
  },
  
  "publisher": {
    "@type": "Organization",
    "name": "CUONG SAI",
    "logo": {
      "@type": "ImageObject",
      "url": "/images/icon_hu47efca792e1e7000f9078d7b8f1dac48_31011_192x192_fill_lanczos_center_2.PNG"
    }
  },
  "description": "Xác định và loại bỏ ouliers trong dữ liệu là một bước vô cùng quan trọng giúp tăng cao độ chính xác cho các mô hình dự đoán"
}
</script>

  

  


  


  





<script type="text/x-mathjax-config">
    MathJax.Hub.Config({
      tex2jax: {
        skipTags: ['script', 'noscript', 'style', 'textarea', 'pre']
      }
    });
    </script>
    <script async type="text/javascript"
      src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
    </script>

  <title>Sử dụng thống kê để xác định và loại bỏ dữ liệu ngoại lai cho machine learning trong R và Python | CUONG SAI</title>

</head>


<body id="top" data-spy="scroll" data-offset="70" data-target="#TableOfContents" class=" ">

  <aside class="search-results" id="search">
  <div class="container">
    <section class="search-header">

      <div class="row no-gutters justify-content-between mb-3">
        <div class="col-6">
          <h1>Search</h1>
        </div>
        <div class="col-6 col-search-close">
          <a class="js-search" href="#"><i class="fas fa-times-circle text-muted" aria-hidden="true"></i></a>
        </div>
      </div>

      <div id="search-box">
        
        <input name="q" id="search-query" placeholder="Search..." autocapitalize="off"
        autocomplete="off" autocorrect="off" spellcheck="false" type="search" class="form-control">
        
      </div>

    </section>
    <section class="section-search-results">

      <div id="search-hits">
        
      </div>

    </section>
  </div>
</aside>


  












<nav class="navbar navbar-expand-lg navbar-light compensate-for-scrollbar" id="navbar-main">
  <div class="container">

    
    <div class="d-none d-lg-inline-flex">
      <a class="navbar-brand" href="/">CUONG SAI</a>
    </div>
    

    
    <button type="button" class="navbar-toggler" data-toggle="collapse"
            data-target="#navbar-content" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
    <span><i class="fas fa-bars"></i></span>
    </button>
    

    
    <div class="navbar-brand-mobile-wrapper d-inline-flex d-lg-none">
      <a class="navbar-brand" href="/">CUONG SAI</a>
    </div>
    

    
    
    <div class="navbar-collapse main-menu-item collapse justify-content-end" id="navbar-content">

      
      <ul class="navbar-nav d-md-inline-flex">
        

        

        
        
        

        

        
        
        
        

        
          
          
        

        <li class="nav-item">
          <a class="nav-link " href="/"><span>HOME</span></a>
        </li>

        
        

        

        
        
        
          
        

        

        
        
        
        

        
          
            
            
          
          
        

        <li class="nav-item">
          <a class="nav-link " href="/about-me/"><span>ABOUT</span></a>
        </li>

        
        

        

        
        
        
          
        

        

        
        
        
        

        
          
            
            
          
          
        

        <li class="nav-item">
          <a class="nav-link " href="/post/"><span>BLOG</span></a>
        </li>

        
        

        

        
        
        
          
        

        

        
        
        
        

        
          
            
            
          
          
            
            
            
              
            
            
          
        

        <li class="nav-item">
          <a class="nav-link " href="/#tags"><span>TOPICS</span></a>
        </li>

        
        

        
        <li class="nav-item dropdown">
          <a href="#" class="nav-link dropdown-toggle" data-toggle="dropdown" aria-haspopup="true"><span>RESEARCH</span><span class="caret"></span>
          </a>
          <div class="dropdown-menu">
            
              <a class="dropdown-item" href="/publication/"><span>All Publications</span></a>
            
              <a class="dropdown-item" href="/#publications"><span>Recent Publications</span></a>
            
              <a class="dropdown-item" href="/#featured"><span>Featured Publications</span></a>
            
              <a class="dropdown-item" href="/#projects"><span>Projects</span></a>
            
              <a class="dropdown-item" href="/#conference"><span>Conferences</span></a>
            
          </div>
        </li>

        
        

        
        <li class="nav-item dropdown">
          <a href="#" class="nav-link dropdown-toggle" data-toggle="dropdown" aria-haspopup="true"><span>TUTORIALS</span><span class="caret"></span>
          </a>
          <div class="dropdown-menu">
            
              <a class="dropdown-item" href="/tutorials/r-tutorials/"><span>R</span></a>
            
              <a class="dropdown-item" href="/tutorials/python-tutorials/"><span>Python</span></a>
            
              <a class="dropdown-item" href="/tutorials/statistics/"><span>Statistics</span></a>
            
          </div>
        </li>

        
        

        

        
        
        
          
        

        

        
        
        
        

        
          
            
            
          
          
            
            
            
              
            
            
          
        

        <li class="nav-item">
          <a class="nav-link " href="/#contact"><span>CONTACT</span></a>
        </li>

        
        

        

        
        
        
          
        

        

        
        
        
        

        
          
            
            
          
          
        

        <li class="nav-item">
          <a class="nav-link " href="/archive/"><span>ARCHIVE</span></a>
        </li>

        
        

      

        
      </ul>
    </div>

    <ul class="nav-icons navbar-nav flex-row ml-auto d-flex pl-md-2">
      
      <li class="nav-item">
        <a class="nav-link js-search" href="#" aria-label="Search"><i class="fas fa-search" aria-hidden="true"></i></a>
      </li>
      

      
      <li class="nav-item dropdown theme-dropdown">
        <a href="#" class="nav-link js-theme-selector" data-toggle="dropdown" aria-haspopup="true">
          <i class="fas fa-palette" aria-hidden="true"></i>
        </a>
        <div class="dropdown-menu">
          <a href="#" class="dropdown-item js-set-theme-light">
            <span>Light</span>
          </a>
          <a href="#" class="dropdown-item js-set-theme-dark">
            <span>Dark</span>
          </a>
          <a href="#" class="dropdown-item js-set-theme-auto">
            <span>Automatic</span>
          </a>
        </div>
      </li>
      

      

    </ul>

  </div>
</nav>


  <article class="article">

  













  
  

  
  
  


<div class="article-container pt-3">
  <h1>Sử dụng thống kê để xác định và loại bỏ dữ liệu ngoại lai cho machine learning trong R và Python</h1>

  

  
    


<div class="article-metadata">

  
  

  
  <span class="article-date">
    
    
      
          Last updated on
      
    
    Aug 20, 2020
  </span>
  

  

  
  <span class="middot-divider"></span>
  <span class="article-reading-time">
    9 min read
  </span>
  

  
  
  
  <span class="middot-divider"></span>
  <a href="/blog/remove-outliers/#disqus_thread"></a>
  

  
  
  <span class="middot-divider"></span>
  <span class="article-categories">
    <i class="fas fa-folder mr-1"></i><a href="/category/r/">R</a>, <a href="/category/python/">Python</a>, <a href="/category/statistics/">Statistics</a></span>
  

</div>

    














  
</div>





  <div class="article-container">

    <div class="article-style">
      <p>
<a href="https://leadupcollective.org/2017/06/02/statistics-high-performers-studying-the-outliers/" target="_blank" rel="noopener">Nguồn ảnh</a>
<img src="/img/outliers1.jpg" alt=""></p>
<p>Outliers (dữ liệu ngoại lai hay là nhiễu) là một trong những thuật ngữ được sử dụng rất rộng rãi trong thế giới data science. Trong quá trình xây dựng các mô hình dự đoán, việc xác định và loại bỏ outliers trong dữ liệu là một bước vô cùng quan trọng. Nó giúp tăng cao độ chính xác cho các mô hình dự đoán.</p>
<p>Khi phân tích, chúng ta thường dùng các tham số như là <code>mean</code>, <code>median</code> và <code>mode</code> để biết xu hướng tập trung của dữ liệu. Tuy nhiên, một câu hỏi quan trọng cần phải trả lời khi xem xét chất lượng của một mẫu dữ liệu trong  phân tích  đó là <em>&ldquo;làm sao để đo được độ biến động (hay độ phân tán) của mẫu dữ liệu đó&rdquo;?</em>.  Vì chúng ta có thể có 2 mẫu dữ liệu với cùng giá trị <code>mean</code> nhưng độ biến động của chúng lại hoàn toàn khác nhau. Trong thống kê những đại lượng phổ biến nhất để đo lường tiêu chí này là khoảng phần tư (interquartile range, <code>IQR</code>) (hay còn được gọi là khoảng cách giữa các tứ phân vị), phương sai (<code>variance</code>) và độ lệch chuẩn (standard deviation, <code>STD</code>).</p>
<p>Ở post này tôi sẽ giới thiệu với các bạn cách sử dụng 2 phương pháp thống kê trong R và Python để xác định và loại bỏ outliers trong dữ liệu đó là:</p>
<ol>
<li><code>STD</code> có thể sử dụng để xác định outliers trong dữ liệu có dạng/gần như dạng phân phối chuẩn (hay còn gọi là phân phối <code>Gauss</code>)</li>
<li><code>IQR</code> có thể sử dụng để xác định và loại bỏ outliers không phụ thuộc vào dạng phân phối của dữ liệu.</li>
</ol>
<p>Và ở cuối post tôi sẽ hướng dẫn các bạn viết hàm tự động xác định và loại bỏ outliers từ dữ liệu sử dụng hai phương pháp trên.</p>
<hr>
<p><strong>1. Tạo dữ liệu  để thực hành</strong></p>
<p>Để thực hành tôi sử dụng hàm mô phỏng phân phối chuẩn <code>rnorm()</code> trong R để tạo ra dãy số ngẫu nhiên gồm <code>5000</code> số với các tham số giá trị trung bình là <code>20</code> và độ lệnh chuẩn là <code>2</code> như sau:</p>
<pre><code class="language-r"># R
data = rnorm(5000, mean = 20, sd = 2)
</code></pre>
<p>Với Python thì ta thực hiện như sau:</p>
<p>Trước hết cần nạp thư viện <code>reticulate</code> để sử dụng Python trong R:</p>
<pre><code class="language-r"># R
library(reticulate)
</code></pre>
<p>Cụ thể về cách sử dụng thư viện <code>reticulate</code> để kết hợp R và Python tôi đã giới thiệu ở post trước, các bạn có thể đọc ở 
<a href="https://svcuong.github.io/post/s-d-ng-k-t-h-p-r-va-python-trong-data-science/" target="_blank" rel="noopener">đây</a></p>
<p>Tạo dữ liệu trong python:</p>
<pre><code class="language-python"># Python
# Tạo dữ liệu tương tự như trong R
from numpy.random import randn
data = 2* randn(5000) + 20
</code></pre>
<p>Trong dữ liệu được tạo ra từ phân phối chuẩn sẽ có một số giá trị nằm cách xa giá trị trung bình <code>mean</code> mà chúng ta có thể xác định là <code>outliers</code>.</p>
<p>Biểu diễn dữ liệu bằng histogam sử dụng hàm <code>hist()</code>:</p>
<pre><code class="language-r"># R
hist(data, breaks= 60, main=&quot;Histogram With breaks=60&quot;)
</code></pre>
<p><img src="/post/2020-08-19-remove-outliers.vn_files/figure-html/unnamed-chunk-4-1.png" width="672" /></p>
<p>Nhân tiện đây tôi cũng xin giới thiệu một số hàm hỗ trợ cho các tính toán thống kê trong R như: <code>summary()</code>, <code>sample()</code>, <code>dnorm()</code>, <code>pnorm()</code>, <code>qnorm()</code>, <code>dunif()</code>, <code>punif()</code>, <code>qunif()</code>, <code>runif()</code>, <code>mean()</code>, <code>sd()</code>, <code>cov()</code>, <code>cor()</code>,&hellip;</p>
<p>Hàm <code>summay()</code> cho phép thực hiện thống kê mô tả (<code>descriptive statistics</code>) để cung cấp cho chúng ta một số thông tin thống kê cơ bản về một biến số:</p>
<pre><code class="language-r"># R
summary(data)
</code></pre>
<pre><code>##    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
##   12.84   18.66   19.99   20.00   21.37   26.96
</code></pre>
<p>Ví dụ sử dụng hàm <code>sample()</code> để tạo mẫu ngẫu nhiên có lặp lại 10 số nguyên từ 0 đến 9:</p>
<pre><code class="language-r"># R
sample(0:9, replace = TRUE)
</code></pre>
<pre><code>##  [1] 8 7 4 3 1 6 9 5 3 3
</code></pre>
<p>Ví dụ sử dụng hàm tính mật độ phân phối chuẩn <code>dnorm()</code> để ước tính xác xuất của học sinh có điểm là <code>16.5</code>  biết rằng điểm của học sinh tuân theo phân phối chuẩn với giá trị trung bình là <code>15</code>, độ lệnh chuẩn là <code>2.5</code>:</p>
<pre><code class="language-r"># R
dnorm(16.5, mean = 15, sd = 2.5)
</code></pre>
<pre><code>## [1] 0.1332898
</code></pre>
<p>Tiếp theo ví dụ trên để ước tính xác suất học sinh có điểm tối thiểu là
<code>16.5</code>, ta có thể sử dụng hàm tính xác suất chuẩn tích lũy <code>pnorm()</code> như sau:</p>
<pre><code class="language-r"># R
1 - pnorm(16.5, mean = 15, sd = 2.5)
</code></pre>
<pre><code>## [1] 0.2742531
</code></pre>
<p>Chức năng của các hàm R còn lại  cũng như các hàm tương tự trong Python các bạn có thể tự tìm hiểu thêm.</p>
<p><strong>2. Phương pháp STD</strong></p>
<p>Nếu như biết được rằng dữ liệu có dạng phân phối <code>Gauss</code> thì chúng ta có thể sử dụng STD trong vài trò là thước đo giới hạn độ phân tán của dữ liệu để xác định outliers.</p>
<p>Trong phân phối <code>Gauss</code> dựa vào giá trị trung bình <code>mean</code> và <code>STD</code> cho phép chúng ta kiểm tra được độ phân tán (hay là phần trăm bao phủ) của dữ liệu đó như thế nào. Ví dụ:</p>
<ul>
<li>Độ bao phủ với <code>1 STD</code> từ mean là <code>68%</code></li>
<li>Độ bao phủ với <code>2 STD</code> từ mean là <code>95%</code></li>
<li>Độ bao phủ với <code>3 STD</code> từ mean là <code>99.7%</code></li>
</ul>
<p><img src="/post/2020-08-19-remove-outliers.vn_files/std.jpg" alt="">

<a href="https://www.students4bestevidence.net/blog/2018/09/26/a-beginners-guide-to-standard-deviation-and-standard-error/" target="_blank" rel="noopener">Nguồn ảnh</a></p>
<p>Vậy nên với dữ liệu dạng <code>Gauss</code> có độ phân tán bình thường thì với <code>3STD</code>, chúng ta sẽ bao phủ được khoảng &gt; <code>99%</code> của dữ liệu. Từ đó những điểm dữ liệu nằm ngoài <code>3STD</code> sẽ được coi là outliers.</p>
<p><strong>Các bước xác định outliers bằng phương pháp <code>STD</code> như sau:</strong></p>
<p>Bước 1: Tính <code>mean</code> và <code>std</code></p>
<pre><code class="language-r"># tính mean và std
# R
mean_data &lt;- mean(data)
std_data &lt;- sd(data)
</code></pre>
<pre><code class="language-python"># Python
from numpy import mean
from numpy import std
mean_data, std_data = mean(data), std(data)
</code></pre>
<p>Bước 2: Tính giá trị biên <code>Upper/Lower</code> để xác định <code>outliers</code></p>
<pre><code class="language-r"># thiết lập giới hạn để xác định outliers
# R
limit_std = 3*std_data
lower_std = mean_data - limit_std
upper_std = mean_data + limit_std
</code></pre>
<pre><code class="language-python"># Python
limit_std = 3*std_data
lower_std, upper_std = mean_data - limit_std, mean_data + limit_std
</code></pre>
<p>Bước 3: Xác định và loại bỏ <code>outliers</code> dựa trên giá trị biên</p>
<pre><code class="language-r"># xác định outliers
# R
ouliers_index_std &lt;- which(data &gt; upper_std | data &lt; lower_std)
print(paste(&quot;Number of outliers:&quot;, length(ouliers_index_std)))
</code></pre>
<pre><code>## [1] &quot;Number of outliers: 16&quot;
</code></pre>
<pre><code class="language-python"># Python
ouliers_index_std = [x for x in data if x &lt; lower_std or x &gt; upper_std]
print('Number of outliers: %d' % len(ouliers_index_std))
</code></pre>
<pre><code>## Number of outliers: 14
</code></pre>
<pre><code class="language-r"># Loại bỏ outliers
# R
data_new_std &lt;- data[-ouliers_index_std]
print(paste(&quot;Number of Non-outliers:&quot;, length(data_new_std)))
</code></pre>
<pre><code>## [1] &quot;Number of Non-outliers: 4984&quot;
</code></pre>
<pre><code class="language-python"># Python
data_new_std = [x for x in data if x &gt;= lower_std and x &lt;= upper_std]
print('Number of Non-outliers:: %d' % len(data_new_std))
</code></pre>
<pre><code>## Number of Non-outliers:: 4986
</code></pre>
<p><strong>2. Phương pháp <code>IQR</code></strong></p>
<p>Tứ phân vị là đại lượng mô tả sự phân bố và sự phân tán của tập dữ liệu. Tứ phân vị có <code>3</code> giá trị, đó là tứ phân vị thứ nhất <code>Q1</code> (25th), thứ hai <code>Q2</code> (50th) hay <code>median</code>, và thứ ba <code>Q3</code> (75th). Ba giá trị này chia một tập hợp dữ liệu (đã sắp xếp dữ liệu theo trật từ từ bé đến lớn) thành <code>4</code> phần có số lượng quan sát đều nhau. Tứ phân vị được xác định như sau:</p>
<ul>
<li>Sắp xếp các số theo thứ tự tăng dần</li>
<li>Cắt dãy số thành <code>4</code> phàn bằng nhau</li>
<li>Tứ phân vị là các giá trị tại vị trí cắt</li>
</ul>
<p><img src="/post/2020-08-19-remove-outliers.vn_files/IQR.png" alt="">

<a href="https://medium.com/@dhwajraj/learning-python-regression-analysis-part-7-handling-outliers-in-data-d36ee9e2130b" target="_blank" rel="noopener">Nguồn ảnh</a></p>
<p><code>IQR</code> là sự khác biệt giữa tứ phân vị thứ nhất <code>Q1</code> và tứ phân vị thứ ba <code>Q3</code>:</p>
<p><code>$$IQR = Q_3 - Q_1$$</code></p>
<p>Giá trị <code>IQR</code> có thể sử dụng để xác định <code>outliers</code> bằng cách thiết lập các giá trị biên <code>Upper/Lower</code> giống với phương pháp <code>STD</code> như sau:  Nếu chúng ta trừ đi <code>kxIQR</code> từ tứ phân vị đầu tiên <code>Q1</code>, bất kỳ giá trị dữ liệu nào nhỏ hơn con số này được coi là giá trị outliers. Tương tự như vậy, nếu chúng ta thêm <code>kxIQR</code> đến tứ phân vị thứ ba <code>Q3</code>, bất kỳ giá trị dữ liệu nào lớn hơn con số này được coi là outliers. Giá trị <code>k</code>  thường được chọn là <code>1.5</code>. Trong trường hợp xác định các <code>extreme outliers</code> có thể dùng giá trị <code>k = 3</code>.</p>
<p><strong>Các bước xác định <code>outliers</code> bằng phương pháp <code>IQR</code>:</strong></p>
<p>Bước 1: Tính <code>IQR</code></p>
<pre><code class="language-r"># Tính IQR
# R
q25 &lt;- quantile(data, 0.25)
q75 &lt;- quantile(data, 0.75)
iqr &lt;- q75 - q25
</code></pre>
<pre><code class="language-python"># Python
import numpy as np
q25, q75 = np.percentile(data, 25), np.percentile(data, 75)
iqr = q75 - q25
</code></pre>
<p>Bước 2: Tính giá trị biên <code>Upper/Lower</code> để xác định <code>outliers</code></p>
<pre><code class="language-r"># thiết lập giới hạn để xác định outliers
# R
limit_iqr = 1.5*iqr
lower_iqr = q25 - limit_iqr
upper_iqr = q75 + limit_iqr
</code></pre>
<pre><code class="language-python"># Python
limit_iqr = 1.5*iqr
lower_iqr, upper_iqr = q25 - limit_iqr, q75 + limit_iqr
</code></pre>
<p>Bước 3: Xác định và loại bỏ <code>outliers</code> dựa trên giá trị biên</p>
<pre><code class="language-r"># xác định outliers
# R
ouliers_index_iqr &lt;- which(data &gt; upper_iqr | data &lt; lower_iqr)
print(paste(&quot;Number of outliers:&quot;, length(ouliers_index_iqr)))
</code></pre>
<pre><code>## [1] &quot;Number of outliers: 30&quot;
</code></pre>
<pre><code class="language-python"># Python
ouliers_index_iqr = [x for x in data if x &lt; lower_iqr or x &gt; upper_iqr]
print('Number of outliers: %d' % len(ouliers_index_iqr))
</code></pre>
<pre><code>## Number of outliers: 35
</code></pre>
<pre><code class="language-r"># Loại bỏ outliers
# R
data_new_iqr &lt;- data[-ouliers_index_iqr]
print(paste(&quot;Number of Non-outliers:&quot;, length(data_new_iqr)))
</code></pre>
<pre><code>## [1] &quot;Number of Non-outliers: 4970&quot;
</code></pre>
<pre><code class="language-python"># Python
data_new_iqr = [x for x in data if x &gt;= lower_iqr and x &lt;= upper_iqr]
print('Non-outlier observations: %d' % len(data_new_iqr))
</code></pre>
<pre><code>## Non-outlier observations: 4965
</code></pre>
<p><strong>3. Xây dựng hàm tự động xác định và loại bỏ <code>outliers</code></strong></p>
<p>Chúng ta có thể tạo một hàm trên R dựa vào các bước ở trên để tự động xác định và xóa outliers như sau:</p>
<pre><code class="language-r"># R
# Tạo hàm tự động xác định và loại bỏ outliers bằng phương pháp STD
find_outliers_std &lt;- function(data) {
  # tính giá trị biên Upper/Lower
  mean_data &lt;- mean(data)
  std_data &lt;- sd(data)
  limit = 3*std_data
  lower = mean_data - limit
  upper = mean_data + limit
  # xác định outliers
  ouliers_index &lt;- which(data &gt; upper | data &lt; lower)
  # Thông báo thông tin về các outliers đã xóa
  if (length(ouliers_index) &gt; 0 ) {
    message(paste(&quot;Number of outliers:&quot;, length(ouliers_index)))
    message(paste(&quot;Number of Non-outliers:&quot;, length(data_new_iqr)))
  # return the data with the outliers removed
  return(data[-ouliers_index])
  } else {
    message(&quot;Not outliers&quot;)
  }
}
</code></pre>
<p>Tương tự ta có thể tạo hàm xác định <code>outliers</code> bằng phương pháp <code>IQR</code> như sau:</p>
<pre><code class="language-r"># Python
# Tạo hàm tự động xác định và loại bỏ outliers bằng phương pháp IQR
find_outliers_iqr &lt;- function(data) {
  # Tính IQR
  q25 &lt;- quantile(data)[2]
  q75 &lt;- quantile(data)[4]
  iqr = q75 - q25 
  # Tính giá trị biên Upper/Lower để xác định outliers
  upper = q75 + iqr * 1.5
  lower = q25 - iqr * 1.5
  # xác định outliers
  ouliers_index &lt;- which(data &gt; upper | data &lt; lower)
  # Thông báo thông tin về các outliers đã xóa
  if (length(ouliers_index) &gt; 0 ) {
    message(paste(&quot;Number of outliers:&quot;, length(ouliers_index)))
    message(paste(&quot;Number of Non-outliers:&quot;, length(data_new_iqr)))
  # return the data with the outliers removed
  # return the data with the outliers removed
  return(data[-ouliers_index])
  } else {
    message(&quot;Not outliers&quot;)
  }
}
</code></pre>
<p>Kiểm tra kết quả thực hiện của hai hàm này:</p>
<pre><code class="language-r">new_data_std &lt;- find_outliers_std(data)
</code></pre>
<pre><code>## Number of outliers: 16
</code></pre>
<pre><code>## Number of Non-outliers: 4970
</code></pre>
<pre><code class="language-r">new_data_iqr &lt;- find_outliers_iqr(data)
</code></pre>
<pre><code>## Number of outliers: 30
</code></pre>
<pre><code>## Number of Non-outliers: 4970
</code></pre>
<p>Đối với Python thì các bạn có thể tạo hàm tương tự sử dụng các bước trên</p>
<hr>

    </div>

    






<div class="article-tags">
  
  <a class="badge badge-light" href="/tag/data-science/">Data Science</a>
  
  <a class="badge badge-light" href="/tag/machine-learning/">Machine Learning</a>
  
  <a class="badge badge-light" href="/tag/deep-learning/">Deep Learning</a>
  
</div>



<div class="share-box" aria-hidden="true">
  <ul class="share">
    
      
      
      
        
      
      
      
      <li>
        <a href="https://twitter.com/intent/tweet?url=/blog/remove-outliers/&amp;text=S%e1%bb%ad%20d%e1%bb%a5ng%20th%e1%bb%91ng%20k%c3%aa%20%c4%91%e1%bb%83%20x%c3%a1c%20%c4%91%e1%bb%8bnh%20v%c3%a0%20lo%e1%ba%a1i%20b%e1%bb%8f%20d%e1%bb%af%20li%e1%bb%87u%20ngo%e1%ba%a1i%20lai%20cho%20machine%20learning%20trong%20R%20v%c3%a0%20Python" target="_blank" rel="noopener" class="share-btn-twitter">
          <i class="fab fa-twitter"></i>
        </a>
      </li>
    
      
      
      
        
      
      
      
      <li>
        <a href="https://www.facebook.com/sharer.php?u=/blog/remove-outliers/&amp;t=S%e1%bb%ad%20d%e1%bb%a5ng%20th%e1%bb%91ng%20k%c3%aa%20%c4%91%e1%bb%83%20x%c3%a1c%20%c4%91%e1%bb%8bnh%20v%c3%a0%20lo%e1%ba%a1i%20b%e1%bb%8f%20d%e1%bb%af%20li%e1%bb%87u%20ngo%e1%ba%a1i%20lai%20cho%20machine%20learning%20trong%20R%20v%c3%a0%20Python" target="_blank" rel="noopener" class="share-btn-facebook">
          <i class="fab fa-facebook"></i>
        </a>
      </li>
    
      
      
      
        
      
      
      
      <li>
        <a href="mailto:?subject=S%e1%bb%ad%20d%e1%bb%a5ng%20th%e1%bb%91ng%20k%c3%aa%20%c4%91%e1%bb%83%20x%c3%a1c%20%c4%91%e1%bb%8bnh%20v%c3%a0%20lo%e1%ba%a1i%20b%e1%bb%8f%20d%e1%bb%af%20li%e1%bb%87u%20ngo%e1%ba%a1i%20lai%20cho%20machine%20learning%20trong%20R%20v%c3%a0%20Python&amp;body=/blog/remove-outliers/" target="_blank" rel="noopener" class="share-btn-email">
          <i class="fas fa-envelope"></i>
        </a>
      </li>
    
      
      
      
        
      
      
      
      <li>
        <a href="https://www.linkedin.com/shareArticle?url=/blog/remove-outliers/&amp;title=S%e1%bb%ad%20d%e1%bb%a5ng%20th%e1%bb%91ng%20k%c3%aa%20%c4%91%e1%bb%83%20x%c3%a1c%20%c4%91%e1%bb%8bnh%20v%c3%a0%20lo%e1%ba%a1i%20b%e1%bb%8f%20d%e1%bb%af%20li%e1%bb%87u%20ngo%e1%ba%a1i%20lai%20cho%20machine%20learning%20trong%20R%20v%c3%a0%20Python" target="_blank" rel="noopener" class="share-btn-linkedin">
          <i class="fab fa-linkedin-in"></i>
        </a>
      </li>
    
      
      
      
        
      
      
      
      <li>
        <a href="whatsapp://send?text=S%e1%bb%ad%20d%e1%bb%a5ng%20th%e1%bb%91ng%20k%c3%aa%20%c4%91%e1%bb%83%20x%c3%a1c%20%c4%91%e1%bb%8bnh%20v%c3%a0%20lo%e1%ba%a1i%20b%e1%bb%8f%20d%e1%bb%af%20li%e1%bb%87u%20ngo%e1%ba%a1i%20lai%20cho%20machine%20learning%20trong%20R%20v%c3%a0%20Python%20/blog/remove-outliers/" target="_blank" rel="noopener" class="share-btn-whatsapp">
          <i class="fab fa-whatsapp"></i>
        </a>
      </li>
    
      
      
      
        
      
      
      
      <li>
        <a href="https://service.weibo.com/share/share.php?url=/blog/remove-outliers/&amp;title=S%e1%bb%ad%20d%e1%bb%a5ng%20th%e1%bb%91ng%20k%c3%aa%20%c4%91%e1%bb%83%20x%c3%a1c%20%c4%91%e1%bb%8bnh%20v%c3%a0%20lo%e1%ba%a1i%20b%e1%bb%8f%20d%e1%bb%af%20li%e1%bb%87u%20ngo%e1%ba%a1i%20lai%20cho%20machine%20learning%20trong%20R%20v%c3%a0%20Python" target="_blank" rel="noopener" class="share-btn-weibo">
          <i class="fab fa-weibo"></i>
        </a>
      </li>
    
  </ul>
</div>












  
  





  
    
    
    
      
    
    
    
    <div class="media author-card content-widget-hr">
      
        
        <img class="avatar mr-3 avatar-circle" src="/author/cuong-sai/avatar_hu52a603635ecebd45650b162dadabb4e5_12861_270x270_fill_q90_lanczos_center.jpg" alt="Cuong Sai">
      

      <div class="media-body">
        <h5 class="card-title"><a href="/">Cuong Sai</a></h5>
        <h6 class="card-subtitle">PhD student</h6>
        <p class="card-text">My research interests include Industrial AI (Intelligent predictive maintenance), Machine and Deep learning, Time series forecasting, Intelligent machinery fault diagnosis, Prognostics and health management, Error metrics / forecast evaluation.</p>
        <ul class="network-icon" aria-hidden="true">
  
    
    
    
      
    
    
    
    
    
      
    
    <li>
      <a href="/#contact" >
        <i class="fas fa-envelope"></i>
      </a>
    </li>
  
    
    
    
      
    
    
    
    
    
      
    
    <li>
      <a href="https://web.facebook.com/csdatascience" target="_blank" rel="noopener">
        <i class="fab fa-facebook"></i>
      </a>
    </li>
  
    
    
    
      
    
    
    
    
    
      
    
    <li>
      <a href="https://github.com/forvis" target="_blank" rel="noopener">
        <i class="fab fa-github"></i>
      </a>
    </li>
  
    
    
    
    
    
    
    
      
    
    <li>
      <a href="https://orcid.org/0000-0003-0478-8838" target="_blank" rel="noopener">
        <i class="ai ai-orcid"></i>
      </a>
    </li>
  
    
    
    
      
    
    
    
    
    
      
    
    <li>
      <a href="https://github.com/svcuong" target="_blank" rel="noopener">
        <i class="fab fa-github"></i>
      </a>
    </li>
  
</ul>

      </div>
    </div>
  







<section id="comments">
  
    
<div id="disqus_thread"></div>
<script>
  let disqus_config = function () {
    
    
    
  };
  (function() {
    if (["localhost", "127.0.0.1"].indexOf(window.location.hostname) != -1) {
      document.getElementById('disqus_thread').innerHTML = 'Disqus comments not available by default when the website is previewed locally.';
      return;
    }
    var d = document, s = d.createElement('script'); s.async = true;
    s.src = 'https://' + "cuongsai" + '.disqus.com/embed.js';
    s.setAttribute('data-timestamp', +new Date());
    (d.head || d.body).appendChild(s);
  })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="https://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>


  
</section>








  
  
  <div class="article-widget content-widget-hr">
    <h3>Related</h3>
    <ul>
      
      <li><a href="/blog/r-python-machine-learning/">Cách dùng keras và tensorflow trong R. So sánh R interface và Python interface cho keras.</a></li>
      
      <li><a href="/blog/s-d-ng-k-t-h-p-r-va-python-trong-data-science/">Sử dụng kết hợp R và Python trong data science</a></li>
      
      <li><a href="/project/pdm-project/">The PdM Project</a></li>
      
      <li><a href="/blog/download-va-truc-quan-hoa-du-lieu-covid-19-tu-john-hopkins-database-su-dung-python-code/">Download và trực quan hóa dữ liệu Covid-19 từ John Hopkins database (sử dụng Python code)</a></li>
      
      <li><a href="/blog/thu-su-dung-jupyter-notebook-%C4%91e-viet-posts-cho-blog.-machine-learning-project-template-voi-python/">Thử sử dụng jupyter notebook để viết posts cho blog. Machine Learning Project Template với Python</a></li>
      
    </ul>
  </div>
  




 
  </div>
</article>

      

    
    
    
      <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0=" crossorigin="anonymous"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.imagesloaded/4.1.4/imagesloaded.pkgd.min.js" integrity="sha256-lqvxZrPLtfffUl2G/e7szqSvPBILGbwmsGE1MKlOi0Q=" crossorigin="anonymous"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.isotope/3.0.6/isotope.pkgd.min.js" integrity="sha256-CBrpuqrMhXwcLLUd5tvQ4euBHCdh7wGlDfNz8vbu/iI=" crossorigin="anonymous"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.5.7/jquery.fancybox.min.js" integrity="sha256-yt2kYMy0w8AbtF89WXb2P1rfjcP/HTHLT7097U8Y5b8=" crossorigin="anonymous"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/instant.page/5.1.0/instantpage.min.js" integrity="sha512-1+qUtKoh9XZW7j+6LhRMAyOrgSQKenQ4mluTR+cvxXjP1Z54RxZuzstR/H9kgPXQsVB8IW7DMDFUJpzLjvhGSQ==" crossorigin="anonymous"></script>

      

      
        
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.1.2/highlight.min.js" integrity="sha512-7t8APmYpzEsZP7CYoA7RfMPV9Bb+PJHa9x2WiUnDXZx3XHveuyWUtvNOexhkierl5flZ3tr92dP1mMS+SGlD+A==" crossorigin="anonymous"></script>
        
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.1.2/languages/r.min.js"></script>
        
      

    

    
    
      <script src="https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.5.1/leaflet.js" integrity="sha256-EErZamuLefUnbMBQbsEqu1USa+btR2oIlCpBJbyD4/g=" crossorigin="anonymous"></script>
    

    
    
    <script>const code_highlighting = true;</script>
    

    
    
    <script>const isSiteThemeDark = false;</script>
    

    
    
    
    
    
    
    <script>
      const search_config = {"indexURI":"/index.json","minLength":1,"threshold":0.3};
      const i18n = {"no_results":"No results found","placeholder":"Search...","results":"results found"};
      const content_type = {
        'post': "Posts",
        'project': "Projects",
        'publication' : "Publications",
        'talk' : "Talks",
        'slides' : "Slides"
        };
    </script>
    

    
    

    
    
    <script id="search-hit-fuse-template" type="text/x-template">
      <div class="search-hit" id="summary-{{key}}">
      <div class="search-hit-content">
        <div class="search-hit-name">
          <a href="{{relpermalink}}">{{title}}</a>
          <div class="article-metadata search-hit-type">{{type}}</div>
          <p class="search-hit-description">{{snippet}}</p>
        </div>
      </div>
      </div>
    </script>
    

    
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/3.2.1/fuse.min.js" integrity="sha256-VzgmKYmhsGNNN4Ph1kMW+BjoYJM2jV5i4IlFoeZA9XI=" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/jquery.mark.min.js" integrity="sha256-4HLtjeVgH0eIB3aZ9mLYF6E8oU5chNdjU6p6rrXpl9U=" crossorigin="anonymous"></script>
    

    
    

    
    

    
    
    <script id="dsq-count-scr" src="https://cuongsai.disqus.com/count.js" async></script>
    

    
    
    
    
    
    
    
    
    
      
    
    
    
    
    <script src="/js/academic.min.3b2b658c61ebd725bd5fc606c89fe44c.js"></script>

    






  
  
  <div class="container">
    <footer class="site-footer">
  
  <p class="powered-by">
    
      <a href="/license/">LICENSE: CC BY-SA</a>
    
    
  </p>
  

  <p class="powered-by">
    © 2020 Cuong Sai. All Rights Reserved
  </p>

  
  






  <p class="powered-by">
    
    Powered by the
    <a href="https://sourcethemes.com/academic/" target="_blank" rel="noopener">Academic theme</a>
    for
    <a href="https://gohugo.io/" target="_blank" rel="noopener">Hugo</a>
    

    
    <span class="float-right" aria-hidden="true">
      <a href="#" class="back-to-top">
        <span class="button_icon">
          <i class="fas fa-chevron-up fa-2x"></i>
        </span>
      </a>
    </span>
    
  </p>
</footer>

  </div>
  

  
<div id="modal" class="modal fade" role="dialog">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title">Cite</h5>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body">
        <pre><code class="tex hljs"></code></pre>
      </div>
      <div class="modal-footer">
        <a class="btn btn-outline-primary my-1 js-copy-cite" href="#" target="_blank">
          <i class="fas fa-copy"></i> Copy
        </a>
        <a class="btn btn-outline-primary my-1 js-download-cite" href="#" target="_blank">
          <i class="fas fa-download"></i> Download
        </a>
        <div id="modal-error"></div>
      </div>
    </div>
  </div>
</div>

</body>
</html>
